{% extends "base.html" %}

{% block title %}BookSaw - Books Manager{% endblock %}

{% block content %}
<!-- Import sections component -->
{% from 'components/sections.html' import hero_section, books_grid_section, section_header, client_section %}

<!-- Hero Section -->
{{ hero_section(featured_books) }}

{% if is_logged_in %}
<!-- Welcome Message for Logged-in Users -->
<section id="welcome-message" class="py-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-md-8">
                <h4><i class="icon icon-user"></i> Welcome back, {{ current_user.username }}!</h4>
                <p class="mb-0">Ready to discover more amazing books? Check out our latest collection below.</p>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Featured Books Section -->
<section id="featured-books">
    <div class="container">
        {{ section_header("Featured Books", "Check out our") }}
        
        <div class="row">
            <div class="col-md-12">
                <div class="product-list" data-aos="fade-up">
                    <div class="row">
                        {% if featured_books %}
                            {% for book in featured_books %}
                            <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
                                <div class="card book-card h-100">
                                    <div class="card-img-top-wrapper" style="height: 250px; overflow: hidden;">
                                        {% if book.cover_id %}
                                            <img src="https://covers.openlibrary.org/b/id/{{ book.cover_id }}-M.jpg" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;"
                                                 onerror="this.src='{{ url_for('static', filename='images/default.png') }}'">
                                        {% else %}
                                            <img src="{{ url_for('static', filename='images/default.png') }}" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;">
                                        {% endif %}
                                    </div>
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title">{{ book.title }}</h5>
                                        {% if book.authors and book.authors|length > 0 %}
                                            <p class="card-text text-muted">
                                                by {{ book.authors|join(', ') }}
                                            </p>
                                        {% endif %}
                                        {% if book.publication_year %}
                                            <p class="card-text"><small class="text-muted">{{ book.publication_year }}</small></p>
                                        {% endif %}
                                        <div class="mt-auto">
                                            <a href="/book/{{ book.id }}" class="btn btn-primary">View Details</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="col-12 text-center py-5">
                                <h3>No featured books available</h3>
                                <p class="text-muted">Check back later for our featured collection.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Popular Books Section -->
<section id="popular-books" class="bookshelf py-5">
    <div class="container">
        {{ section_header("Popular Books", "Most Popular") }}
        
        <div class="row">
            <div class="col-md-12">
                <div class="product-list" data-aos="fade-up">
                    <div class="row">
                        {% if popular_books %}
                            {% for book in popular_books %}
                            <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
                                <div class="card book-card h-100">
                                    <div class="card-img-top-wrapper" style="height: 250px; overflow: hidden;">
                                        {% if book.cover_id %}
                                            <img src="https://covers.openlibrary.org/b/id/{{ book.cover_id }}-M.jpg" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;"
                                                 onerror="this.src='{{ url_for('static', filename='images/default.png') }}'">
                                        {% else %}
                                            <img src="{{ url_for('static', filename='images/default.png') }}" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;">
                                        {% endif %}
                                    </div>
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title">{{ book.title }}</h5>
                                        {% if book.authors and book.authors|length > 0 %}
                                            <p class="card-text text-muted">
                                                by {{ book.authors|join(', ') }}
                                            </p>
                                        {% endif %}
                                        {% if book.publication_year %}
                                            <p class="card-text"><small class="text-muted">{{ book.publication_year }}</small></p>
                                        {% endif %}
                                        <div class="mt-auto">
                                            <a href="/book/{{ book.id }}" class="btn btn-primary">View Details</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="col-12 text-center py-5">
                                <h3>No popular books available</h3>
                                <p class="text-muted">Check back later for our popular collection.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Latest Books Section -->
<section id="latest-books" class="py-5">
    <div class="container">
        {{ section_header("Latest Books", "Recently Added") }}
        
        <div class="row">
            <div class="col-md-12">
                <div class="product-list" data-aos="fade-up">
                    <div class="row">
                        {% if latest_books %}
                            {% for book in latest_books %}
                            <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
                                <div class="card book-card h-100">
                                    <div class="card-img-top-wrapper" style="height: 250px; overflow: hidden;">
                                        {% if book.cover_id %}
                                            <img src="https://covers.openlibrary.org/b/id/{{ book.cover_id }}-M.jpg" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;"
                                                 onerror="this.src='{{ url_for('static', filename='images/default.png') }}'">
                                        {% else %}
                                            <img src="{{ url_for('static', filename='images/default.png') }}" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;">
                                        {% endif %}
                                    </div>
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title">{{ book.title }}</h5>
                                        {% if book.authors and book.authors|length > 0 %}
                                            <p class="card-text text-muted">
                                                by {{ book.authors|join(', ') }}
                                            </p>
                                        {% endif %}
                                        {% if book.publication_year %}
                                            <p class="card-text"><small class="text-muted">{{ book.publication_year }}</small></p>
                                        {% endif %}
                                        <div class="mt-auto">
                                            <a href="/book/{{ book.id }}" class="btn btn-primary">View Details</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="col-12 text-center py-5">
                                <h3>No latest books available</h3>
                                <p class="text-muted">Check back later for our newest additions.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Categories Section with Tabs -->
<section id="categories-section" class="py-5 bg-light">
    <div class="container">
        {{ section_header("Browse by Category", "Discover") }}
        
        <div class="row">
            <div class="col-md-12">
                {% include 'components/category_tabs.html' %}
            </div>
        </div>
    </div>
</section>

<!-- Special Offer Section -->
<section id="special-offer" class="bookshelf py-5">
    <div class="container">
        {{ section_header("Special Offers", "Don't Miss") }}
        
        <div class="row">
            <div class="col-md-12">
                <div class="product-list" data-aos="fade-up">
                    <div class="row">
                        {% if special_books %}
                            {% for book in special_books %}
                            <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
                                <div class="card book-card h-100">
                                    <div class="card-img-top-wrapper" style="height: 250px; overflow: hidden;">
                                        {% if book.cover_id %}
                                            <img src="https://covers.openlibrary.org/b/id/{{ book.cover_id }}-M.jpg" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;"
                                                 onerror="this.src='{{ url_for('static', filename='images/default.png') }}'">
                                        {% else %}
                                            <img src="{{ url_for('static', filename='images/default.png') }}" 
                                                 alt="{{ book.title }}" class="card-img-top h-100 w-100" style="object-fit: cover;">
                                        {% endif %}
                                    </div>
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title">{{ book.title }}</h5>
                                        {% if book.authors and book.authors|length > 0 %}
                                            <p class="card-text text-muted">
                                                by {{ book.authors|join(', ') }}
                                            </p>
                                        {% endif %}
                                        {% if book.publication_year %}
                                            <p class="card-text"><small class="text-muted">{{ book.publication_year }}</small></p>
                                        {% endif %}
                                        <div class="mt-auto">
                                            <a href="/book/{{ book.id }}" class="btn btn-primary">View Details</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="col-12 text-center py-5">
                                <h3>No special offers available</h3>
                                <p class="text-muted">Check back later for special deals.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Statistics Section -->
<section id="stats-section" class="py-5">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-3 mb-4">
                <div class="stat-item">
                    <h2 class="stat-number">{{ stats.total_books or 0 }}</h2>
                    <p class="stat-label">Total Books</p>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="stat-item">
                    <h2 class="stat-number">{{ stats.total_authors or 0 }}</h2>
                    <p class="stat-label">Authors</p>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="stat-item">
                    <h2 class="stat-number">{{ stats.total_categories or 0 }}</h2>
                    <p class="stat-label">Categories</p>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="stat-item">
                    <h2 class="stat-number">{{ stats.total_languages or 0 }}</h2>
                    <p class="stat-label">Languages</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Client Logos -->
{{ client_section() }}

<style>
.stat-item {
    padding: 2rem 1rem;
    border-radius: 8px;
    background: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
}

.stat-item:hover {
    transform: translateY(-5px);
}

.stat-number {
    font-size: 3rem;
    font-weight: bold;
    color: #d4a574;
    margin-bottom: 0.5rem;
}

.stat-label {
    font-size: 1.1rem;
    color: #666;
    margin: 0;
}

#latest-blog {
    display: none; /* Hide blog section for now */
}
</style>
{% endblock %}